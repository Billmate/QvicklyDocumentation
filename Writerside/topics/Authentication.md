# Authentication

To authenticate with Qvickly you have to use your [API Credentials](API-Credentials.md)

The credentials consist of three elements:

| Name | Type   | Description                                                                                                                                            |
|------|--------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| id   | string | consists of your Merchant ID (eid) - a unique number that identifies your e-store.                                                                     |
| key  | string | A string which is associated with your Merchant ID and is used to authorize with. The secret key from Qvickly, being used for generating the hash key. |
| hash | string | A key generated by the HMAC method with SHA-512. This is used for verifying that the request is correct and from a valid server.                       |



## Credentials in payload

<code-block lang="json">
{
    "credentials": {
        "id": "12345",
        "hash": "080ed3cec93c064b62afb6390a247efbfc821c1585ac16b93bd4cee780b8b5e6ec4ba79d0ed7fc9b575ff5892c9999de31bcdbc74a8957a5b32bfc8d9e1881d1",
        "version": "2.1.6",
        "client": "Pluginname:BillMate:1.0",
        "language": "sv",
        "serverdata": { "..." },
        "time": "1417004339.9291 ",
        "test": "true"
    },
    "data": {
        "timestamp": "1417004339.9291"
    }
}
</code-block>

### Credentials
| Property   | Required | Type    | Description                                                                                                                                                                                                                                                                        |
|------------|----------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| id         | true     | int     | The store ID from Qvickly.                                                                                                                                                                                                                                                         |
| hash       | true     | string  | Hash key using the HMAC method with SHA-512. This is used for verifying that the request is correct and fom a valid server. <br/>Key - Qvickly key.<br/>Argument Data - array as json encoded string.                                                                              |
| version    | false    | string  | Version of the Qvickly API. Currently 2.1.7. Currently not mandatory, but helps when debugging in logs.                                                                                                                                                                            |
| client     | false    | string  | A unique name to identify client and version of client. Can be set by a plugin developer.                                                                                                                                                                                          |
| language   | false    | string  | This is the language of the api, this will decide what language we will return for example error messages. Language codes used according to ISO 639-1, Currently supported sv, en.                                                                                                 |
| serverdata | false    | string  | Web shop server data. For example user agent of the customer browser. Very useful for debugging.                                                                                                                                                                                   |
| time       | false    | decimal | Time when request was submitted. Time format is “PHP microtime”, which is seconds since the Unix Epoch (00000 January 1, 1970 GMT). If used, then logs will show “client time”, which is the time it takes for the request to reach Qvickly servers. Good for debugging of delays. |
| test       | false    | boolean | If test mode, a real credit check will not be made. Default is false.                                                                                                                                                                                                              |

**key** The secret key from Qvickly. Is being used for generating the hash key.

### Data
The data in the payload can be different depending on which method is being called. See the documentation for each method for more information.

> **Note:** The data in the payload is mandatory and can NOT be empty. If there is no data to send, send a timestamp or any other undefined property (such as 'dummy').
> {style="warning"}

## Generate hash key
<tabs>
  <tab title="PHP">
    <code-block lang="php">
      $hash = hash_hmac('sha512', json_encode($data), $key);
    </code-block>
  </tab>

  <tab title="Python">
    <code-block lang="python">
      dataString = simplejson.dumps(data, separators=(',', ':'))
      dataString = dataString.replace('/', '\\/')
      secret = bytes(secret, 'utf-8')
      hash = hmac.new(secret, dataString.encode(), digestmod=hashlib.sha512).hexdigest()
    </code-block>
    <note>
        Using simplejson to encode the data to a string. Making sure that comma and colons are used and that the forward slash is escaped.
    </note>
  </tab>

</tabs>
